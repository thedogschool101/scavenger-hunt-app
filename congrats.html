<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ‰ You Did It!</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #4A148C;
      color: white;
      text-align: center;
      padding: 2rem;
    }
    .card {
      background: #fff;
      color: #4A148C;
      padding: 2rem;
      border-radius: 10px;
      max-width: 600px;
      margin: 2rem auto;
    }
    button {
      background-color: #B359D9;
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      font-size: 1rem;
      border-radius: 8px;
      margin: 0.5rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸ‰ You Did It, Superstar!</h1>
    <p>You've sniffed your way through every clue in the Dog School Scavenger Hunt! ğŸ¶</p>
    <p><strong>Want to win tasty treats?</strong> Share your achievement on Facebook:</p>

    <a href="https://www.facebook.com/sharer/sharer.php?u=https://thedogschool101.co.uk&quote=Iâ€™ve completed the Dog Hunt! ğŸ¾ Join the fun, sniff out clues, and fetch some laughs! ğŸ•â€ğŸ¦º Check out everything The Dog Training School offers: https://thedogschool101.co.uk ğŸ¾ Play the hunt: https://thedogschool101.github.io/scavenger-hunt-app #DogHuntComplete @DogTrainingSchool101" target="_blank">
      <button>ğŸ“£ Share to Your Timeline</button>
    </a>

    <a href="https://www.facebook.com/DogTrainingSchool101" target="_blank">
      <button>ğŸ“¸ Post to The Dog School 101 Page</button>
    </a>

    <p>Once you've posted, click below:</p>
    <button onclick="confirmPosted()">âœ… Iâ€™ve Posted My Photo!</button>

    <div id="status"></div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDeTF1VT20rZEUz_46SqIWqcNAmFRyb-YA",
      authDomain: "doghuntapp.firebaseapp.com",
      projectId: "doghuntapp",
      storageBucket: "doghuntapp.appspot.com",
      messagingSenderId: "516842466897",
      appId: "1:516842466897:web:78d992f9fad6c9d5ad1270"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    async function confirmPosted() {
      const email = localStorage.getItem("userEmail") || "unknown@anonymous.com";
      try {
        const snapshot = await db.collection("players").where("email", "==", email).get();
        if (!snapshot.empty) {
          const docRef = snapshot.docs[0].ref;
          await docRef.update({
            finished: true,
            finished_time: new Date(),
            photo_shared_confirmed: true
          });
          document.getElementById("status").textContent = "ğŸ‰ You're entered into the prize draw! Good luck, tail-wagger!";
        }
      } catch (err) {
        document.getElementById("status").textContent = "ğŸ¾ Woof! Something went wrong. Try again later.";
        console.error("Firebase update failed:", err);
      }
    }
  </script>
</body>
</html>

